import torch

t0 = torch.tensor([[[0.0014, 0.0057],
         [0.0000, 0.0000]],

        [[0.0047, 0.0057],
         [0.0014, 0.0057]],

        [[0.0036, 0.0057],
         [0.0047, 0.0057]],

        [[0.0021, 0.0057],
         [0.0036, 0.0057]],

        [[0.0010, 0.0057],
         [0.0021, 0.0057]],

        [[0.0008, 0.0057],
         [0.0010, 0.0057]],

        [[0.0005, 0.0057],
         [0.0008, 0.0057]],

        [[0.0002, 0.0057],
         [0.0005, 0.0057]]])

print('shape', t0.shape)
# t x-u
t1 = torch.sub(t0, torch.tensor([0.0017, 0.0050]).expand_as(t0))
# calc x-u
t2 = torch.FloatTensor([[[-0.0004,  0.0007],
         [-0.0017, -0.0050]],

        [[ 0.0030,  0.0007],
         [-0.0004,  0.0007]],

        [[ 0.0018,  0.0007],
         [ 0.0030,  0.0007]],

        [[ 0.0003,  0.0007],
         [ 0.0018,  0.0007]],

        [[-0.0007,  0.0007],
         [ 0.0003,  0.0007]],

        [[-0.0010,  0.0007],
         [-0.0007,  0.0007]],

        [[-0.0013,  0.0007],
         [-0.0010,  0.0007]],

        [[-0.0015,  0.0007],
         [-0.0013,  0.0007]]])

print('correct\n', t1)
print(t2)


t3 = t1 / torch.FloatTensor([0.0015, 0.0019])
t4 = t2 / torch.FloatTensor([0.0015, 0.0019])
print(t3, t4)